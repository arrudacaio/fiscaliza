{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\arrud\\\\fiscaliza\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\arrud\\\\fiscaliza\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\arrud\\\\fiscaliza\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,Fragment}from'react';import Card from'../../components/Card/Card';import currency from'currency.js';import'./styles.css';import api from'../../services/api';export default function Main(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),deputado=_useState2[0],setDeputado=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),img=_useState4[0],setImg=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),id=_useState6[0],setId=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),partido=_useState8[0],setPartido=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),gastos=_useState10[0],setGastos=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),ano=_useState12[0],setAno=_useState12[1];function somaValores(lista){var total=0;for(var i=0;i<lista.length;i++){total+=lista[i];}return total;}var getDeputado=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var user,_ano,res,dados,despesas,listaDados,_gastos,totalGastos;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;e.preventDefault();user=e.target.elements.deputado.value;_ano=e.target.elements.ano.value;setAno(_ano);if(!(user&&_ano)){_context.next=21;break;}_context.next=8;return api.get(\"?nome=\".concat(user));case 8:res=_context.sent;dados=res.data.dados[0];_context.next=12;return api.get(\"/\".concat(dados.id,\"/despesas?ano=\").concat(_ano,\"&ordem=ASC&ordenarPor=ano\"));case 12:despesas=_context.sent;listaDados=despesas.data.dados;setId(dados.id);setDeputado(dados.nome);setImg(dados.urlFoto);setPartido(dados.siglaPartido);_gastos=listaDados.map(function(despesa){if(despesa.ano===Number(_ano)){return despesa.valorLiquido;}});totalGastos=somaValores(_gastos);//setGastos(totalGastos.toFixed(2));\nsetGastos(currency(totalGastos.toFixed(2),{separator:' '}).format());case 21:_context.next=26;break;case 23:_context.prev=23;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 26:case\"end\":return _context.stop();}}},_callee,null,[[0,23]]);}));return function getDeputado(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"logo\"},/*#__PURE__*/React.createElement(\"h1\",null,\"FISCALIZA\"),/*#__PURE__*/React.createElement(\"p\",null,\"consulte os gastos dos parlamentares com mandato em andamento\")),/*#__PURE__*/React.createElement(\"form\",{onSubmit:getDeputado},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",placeholder:\"Nome do deputado\",name:\"deputado\"}),/*#__PURE__*/React.createElement(\"input\",{id:\"number\",type:\"number\",placeholder:\"Ano\",name:\"ano\"}),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},\"Pesquisar\")),deputado&&ano?/*#__PURE__*/React.createElement(Card,{img:img,deputado:deputado,partido:partido,ano:ano,gastos:gastos}):/*#__PURE__*/React.createElement(Fragment,null),/*#__PURE__*/React.createElement(\"footer\",null,/*#__PURE__*/React.createElement(\"p\",null,\"Todos os dados foram retirados da API de Dados Abertos da C\\xE2mara dos Deputados\")));}","map":{"version":3,"sources":["C:/Users/arrud/fiscaliza/src/pages/Main/index.js"],"names":["React","useState","Fragment","Card","currency","api","Main","deputado","setDeputado","img","setImg","id","setId","partido","setPartido","gastos","setGastos","ano","setAno","somaValores","lista","total","i","length","getDeputado","e","preventDefault","user","target","elements","value","get","res","dados","data","despesas","listaDados","nome","urlFoto","siglaPartido","map","despesa","Number","valorLiquido","totalGastos","toFixed","separator","format","console","log"],"mappings":"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","sourcesContent":["import React, {useState, Fragment} from 'react';\r\nimport Card from '../../components/Card/Card';\r\nimport currency from 'currency.js';\r\nimport './styles.css';\r\nimport api from '../../services/api';\r\n\r\nexport default function Main(){\r\n  const [deputado, setDeputado] = useState('');\r\n  const [img, setImg ] = useState('');\r\n  const [id, setId] = useState('');\r\n  const [partido, setPartido] = useState('');\r\n  const [gastos, setGastos] = useState();\r\n  const [ano, setAno] = useState();\r\n  \r\n\r\n\r\n  function somaValores(lista){\r\n    var total = 0;\r\n    for(var i = 0; i < lista.length; i++){\r\n      total += lista[i];\r\n    } \r\n    return total;\r\n  }\r\n\r\n  const getDeputado = async (e) => {\r\n    try {\r\n      e.preventDefault();\r\n\r\n      const user = e.target.elements.deputado.value;\r\n      const ano = e.target.elements.ano.value;\r\n      setAno(ano);\r\n\r\n      if(user && ano) {\r\n        const res = await api.get(`?nome=${user}`);\r\n        const dados = res.data.dados[0]; \r\n        const despesas = await api.get(`/${dados.id}/despesas?ano=${ano}&ordem=ASC&ordenarPor=ano`);\r\n        const listaDados = despesas.data.dados;\r\n        \r\n\r\n        setId(dados.id);\r\n        setDeputado(dados.nome);\r\n        setImg(dados.urlFoto);\r\n        setPartido(dados.siglaPartido);\r\n        \r\n        \r\n        const gastos = listaDados.map(despesa => {\r\n          if(despesa.ano === Number(ano)){\r\n            return despesa.valorLiquido;\r\n          }\r\n        });\r\n\r\n        var totalGastos = somaValores(gastos);\r\n        //setGastos(totalGastos.toFixed(2));\r\n        setGastos(currency(totalGastos.toFixed(2), { separator: ' ' }).format());\r\n\r\n \r\n\r\n      }\r\n\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n\r\n  }\r\n\r\n  return(\r\n    <div className=\"container\">\r\n      <div className=\"logo\">\r\n        <h1>FISCALIZA</h1>\r\n        <p>consulte os gastos dos parlamentares com mandato em andamento</p>\r\n      </div>\r\n      <form onSubmit={getDeputado}>\r\n        <input type=\"text\" placeholder=\"Nome do deputado\" name=\"deputado\"/>\r\n        <input id=\"number\" type=\"number\" placeholder=\"Ano\" name=\"ano\"/>\r\n        <button type=\"submit\">Pesquisar</button>\r\n      </form>\r\n      {\r\n        deputado && ano ?\r\n        <Card \r\n          img={img}\r\n          deputado={deputado}\r\n          partido={partido}\r\n          ano={ano}\r\n          gastos={gastos}\r\n        /> : <Fragment />\r\n      }\r\n      <footer>\r\n        <p>Todos os dados foram retirados da API de Dados Abertos da CÃ¢mara dos Deputados</p>\r\n      </footer>\r\n\r\n    </div>\r\n  );\r\n\r\n\r\n\r\n\r\n}"]},"metadata":{},"sourceType":"module"}